{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<main class="admin-dashboard-main">
  <h1>Admin Dashboard</h1>
  <section class="admin-section">
    <h2>Users</h2>
    <table class="admin-table">
      <thead>
        <tr><th>ID</th><th>Name</th><th>Email</th></tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr><td>{{ u.id }}</td><td>{{ u.name }}</td><td>{{ u.email }}</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section class="admin-section">
    <h2>Recent Messages</h2>
    <a class="btn btn-primary" href="/admin/export">Export CSV</a>
    <form method="POST" action="/admin/prune" class="admin-prune-form">
      <label>Prune messages older than <input type="number" name="days" value="30" class="form-control-sm"> days</label>
      <button class="btn btn-primary btn-sm" type="submit">Prune</button>
    </form>
    <div class="admin-messages-list">
      {% for m in messages %}
        <div class="admin-message-item">
          <div class="admin-message-meta">{{ m.created_at }} — user_id: {{ m.user_id }} — {{ m.role }}</div>
          <div class="admin-message-content">{{ m.content }}</div>
        </div>
      {% endfor %}
    </div>
  </section>
</main>
{% endblock %}